const API=import.meta.env.VITE_API_URL; export async function api(p,{method='GET',body}={}){ const o={method,headers:{'Content-Type':'application/json'}}; if(body) o.body=JSON.stringify(body); const r=await fetch(`${API}${p}`,o); if(!r.ok){const t=await r.text().catch(()=>''),e=t?(()=>{try{return JSON.parse(t).error}catch{return ''}})():''; throw new Error(e||`Request failed (${r.status})`);} const t=await r.text(); return t?JSON.parse(t):{} }